/*
 * generated by Xtext 2.10.0
 */
package at.jku.weiner.mttf.tests

import at.jku.weiner.mttf.mttf.TestSuite
import com.google.inject.Inject
import org.eclipse.xtext.junit4.InjectWith
import org.eclipse.xtext.junit4.XtextRunner
import org.eclipse.xtext.junit4.util.ParseHelper
import org.junit.Assert
import org.junit.Test
import org.junit.runner.RunWith
import org.eclipse.xtext.junit4.validation.ValidationTestHelper

@RunWith(XtextRunner)
@InjectWith(MttfInjectorProvider)
class MttfParsingTest{

	@Inject
	ParseHelper<TestSuite> parseHelper
	@Inject 
	ValidationTestHelper validationHelper

	@Test 
	def void testSimpleTestSuite() {
		val result = parseHelper.parse('''
			test-suite
				source-metamodel="workspace:/Test/Class.ecore"
				target-metamodel="workspace:/Test/Relational.ecore"
				transformation="workspace:/Test/Class2Relational.atl"
		''')
		Assert.assertNotNull(result)
		validationHelper.assertNoErrors(result)
		Assert.assertNull(result.name)
		val sut = result.sut
		Assert.assertNotNull(sut)
		val sourceMM = sut.sourceMetaModel
		Assert.assertNotNull(sourceMM)
		Assert.assertEquals("workspace:/Test/Class.ecore", sourceMM.uri);
		val targetMM = sut.targetMetaModel
		Assert.assertNotNull(targetMM)
		Assert.assertEquals("workspace:/Test/Relational.ecore", targetMM.uri);
		val trafo = sut.transformationUnderTest
		Assert.assertNotNull(trafo)
		Assert.assertEquals("workspace:/Test/Class2Relational.atl", trafo.uri);
		Assert.assertNotNull(result.testCases)
		Assert.assertTrue(result.testCases.isEmpty())
	}
	
	@Test 
	def void testSimpleTestSuiteWithName() {
		val result = parseHelper.parse('''
			test-suite name=Class2Relational_TestSuite
				source-metamodel="workspace:/Test/Class.ecore"
				target-metamodel="workspace:/Test/Relational.ecore"
				transformation="workspace:/Test/Class2Relational.atl"
		''')
		Assert.assertNotNull(result)
		validationHelper.assertNoErrors(result)
		Assert.assertEquals("Class2Relational_TestSuite", result.name)
	}

}
